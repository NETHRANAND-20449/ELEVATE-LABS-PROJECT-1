# web_interface/templates/scan_results.html
"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scan Results - Web Vulnerability Scanner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>🔒 Scan Results</h1>
            <p>Target: {{ target_url }}</p>
            <a href="/" class="back-link">← Back to Scanner</a>
        </header>
        
        <div class="results-summary">
            <h2>Summary</h2>
            <p><strong>Total Vulnerabilities:</strong> {{ vulnerabilities|length }}</p>
            
            {% set severity_counts = {'Critical': 0, 'High': 0, 'Medium': 0, 'Low': 0} %}
            {% for vuln in vulnerabilities %}
                {% set _ = severity_counts.update({vuln.severity: severity_counts[vuln.severity] + 1}) %}
            {% endfor %}
            
            <div class="severity-summary">
                <span class="severity critical">Critical: {{ severity_counts['Critical'] }}</span>
                <span class="severity high">High: {{ severity_counts['High'] }}</span>
                <span class="severity medium">Medium: {{ severity_counts['Medium'] }}</span>
                <span class="severity low">Low: {{ severity_counts['Low'] }}</span>
            </div>
        </div>
        
        <div class="vulnerabilities-list">
            <h2>Detailed Findings</h2>
            {% for vuln in vulnerabilities %}
            <div class="vulnerability {{ vuln.severity.lower() }}">
                <div class="vuln-header">
                    <h3>{{ vuln.type }} - {{ vuln.severity }}</h3>
                    <span class="vuln-id">#{{ loop.index }}</span>
                </div>
                <div class="vuln-details">
                    <p><strong>URL:</strong> {{ vuln.url }}</p>
                    <p><strong>Method:</strong> {{ vuln.method.upper() }}</p>
                    <p><strong>Parameter:</strong> {{ vuln.parameter }}</p>
                    <p><strong>Description:</strong> {{ vuln.description }}</p>
                    <div class="evidence">
                        <strong>Evidence:</strong><br>
                        {{ vuln.evidence }}<br>
                        {% if vuln.payload != 'N/A' %}
                        <strong>Payload:</strong> <code>{{ vuln.payload }}</code>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
            
            {% if vulnerabilities|length == 0 %}
            <div class="no-vulnerabilities">
                <h3>🎉 No vulnerabilities found!</h3>
                <p>The target appears to be secure against the tested attack vectors.</p>
            </div>
            {% endif %}
        </div>
        
        <div class="action-buttons">
            <button onclick="downloadReport()">Download Full Report</button>
            <button onclick="window.print()">Print Results</button>
        </div>
    </div>
    
    <script>
        function downloadReport() {
            window.location.href = '/download_report';
        }
    </script>
</body>
</html>
"""
